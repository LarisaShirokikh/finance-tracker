[tool:pytest]
# Pytest configuration for Finance Tracker

# Test discovery
testpaths = tests
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*

# Minimum version
minversion = 7.0

# Default options
addopts = 
    -ra
    --strict-markers
    --strict-config
    --verbose
    --tb=short
    --showlocals
    --durations=10

# Markers for test categorization
markers =
    unit: Unit tests (fast, no external dependencies)
    integration: Integration tests (slower, may use external services)
    redis: Tests that require Redis
    keycloak: Tests that require Keycloak
    slow: Slow tests (deselect with '-m "not slow"')
    auth: Authentication related tests
    api: API endpoint tests
    security: Security related tests

# Async support
asyncio_mode = auto

# Coverage settings (if using pytest-cov)
# Uncomment these lines if you install pytest-cov
# addopts = --cov=app --cov-report=html --cov-report=term-missing
# cov_report = html:htmlcov

# Test output
console_output_style = progress

# Warnings
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    # Ignore specific warnings from dependencies
    ignore:.*use of deprecated.*:DeprecationWarning
    ignore:.*pkg_resources.*:DeprecationWarning

# Environment variables for testing
env =
    DEBUG = true
    LOG_LEVEL = ERROR
    REDIS_URL = redis://localhost:6379/15
    TESTING = true

# Test timeout (prevent hanging tests)
timeout = 300

# Parallel execution (if using pytest-xdist)
# addopts = -n auto

# Test order randomization (if using pytest-randomly)
# addopts = --randomly-seed=12345